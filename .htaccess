# Django cPanel Passenger Configuration

# Enable Passenger
PassengerEnabled On
PassengerAppRoot /home/axmedova/website

# Set Python interpreter path (update with your actual path)
PassengerPython /home/axmedova/virtualenv/website/3.12/bin/python

# Set startup file
PassengerStartupFile passenger_wsgi.py

# Set application environment
PassengerAppEnv production

# Error handling
ErrorDocument 500 "Internal Server Error - Please contact the site administrator"

# Force HTTPS (uncomment after SSL is configured)
# RewriteEngine On
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Serve static and media files directly
<IfModule mod_rewrite.c>
    RewriteEngine On

    # Serve media files FIRST (before static)
    RewriteCond %{REQUEST_URI} ^/media/
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^media/(.*)$ /home/axmedova/website/media/$1 [L]

    # Serve static files
    RewriteCond %{REQUEST_URI} ^/static/
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^static/(.*)$ /home/axmedova/website/staticfiles/$1 [L]
    
    # Fallback to Django for all other requests
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ passenger_wsgi.py [QSA,L]
</IfModule>

# Browser caching for static files
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/x-javascript "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
</IfModule>

# Compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/javascript application/x-javascript
</IfModule>
